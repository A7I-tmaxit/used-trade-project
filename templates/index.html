<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITí¬ë§ ì¤‘ê³ ê±°ë˜</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/style.css">
</head>
<body>
    <!-- Header with Carrot Emojis on Both Sides -->
    <header class="text-center py-4" id="header">
        <div class="title-box d-flex justify-content-center align-items-center">
            <span class="emoji me-2">ğŸ¥•</span>
            <h1 style="white-space: nowrap;">IT í¬ë§ ì¤‘ê³ ê±°ë˜</h1>
            <span class="emoji ms-2">ğŸ¥•</span>
        </div>
    </header>

    <!-- Login Section (Visible Initially) -->
    <section id="login" class="text-center" style="max-width: 400px;">
        <h2 class="mb-3">Login</h2>
        <div class="mb-3">
            <input type="text" class="form-control" id="loginUsername" placeholder="Username">
        </div>
        <div class="mb-3">
            <input type="password" class="form-control" id="loginPassword" placeholder="Password">
        </div>
        <button class="btn btn-primary w-100" onclick="login()">Login</button>
        <div id="loginMessage" class="mt-3 text-danger"></div>
        <p class="mt-4">ì•„ì§ íšŒì›ì´ ì•„ë‹ˆë¼ë©´ <span class="text-decoration-underline text-primary" onclick="showSection('register')">íšŒì›ê°€ì…í•˜ì„¸ìš”</span></p>
    </section>

    <!-- Register Section (Initially Hidden) -->
    <section id="register" class="d-none text-center" style="max-width: 400px;">
        <h2 class="mb-3">Register</h2>
        <div class="mb-3">
            <input type="text" class="form-control" id="registerUsername" placeholder="Username">
        </div>
        <div class="mb-3">
            <input type="password" class="form-control" id="registerPassword" placeholder="Password">
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" id="registerName" placeholder="Full Name">
        </div>
        <div class="mb-3">
            <input type="number" class="form-control" id="registerBalance" placeholder="Account Balance">
        </div>
        <button class="btn btn-success w-100" onclick="register()">Register</button>
        <div id="registerMessage" class="mt-3 text-danger"></div>
        <p class="mt-4">ì´ë¯¸ ê³„ì •ì´ ìˆë‹¤ë©´ <span class="text-decoration-underline text-primary" onclick="showSection('login')">ë¡œê·¸ì¸ í•˜ê¸°</span></p>
    </section>

    <!-- Main Content Section -->
    <div id="mainPage" class="d-none">
        <div class="container mt-3 d-flex justify-content-center" id="buttonRow">
            <input type="text" class="form-control w-50 me-2" id="searchBar" placeholder="ìƒí’ˆëª…, ì§€ì—­ëª…, @ìƒì ëª… ì…ë ¥">
            <button class="btn btn-outline-warning me-2" onclick="searchItems()">ê²€ìƒ‰</button>
            <button class="btn btn-outline-warning me-2" onclick="showSellPage()">íŒë§¤í•˜ê¸°</button>
            <button class="btn btn-outline-warning" onclick="showMyPage()">ë§ˆì´í˜ì´ì§€</button>
        </div>
        <main class="container my-5">
            <section id="productList" class="d-flex flex-wrap"></section>
        </main>
    </div>

    <!-- Sell Page -->
    <div id="sellPage" class="d-none">
        <div class="container">
            <button class="btn btn-secondary mb-3" onclick="showMainPage()">â† í™ˆìœ¼ë¡œ</button>
            <h2 class="text-center mt-5">ìƒí’ˆ íŒë§¤í•˜ê¸°</h2>
            <div class="mb-3">
                <label for="productImage" class="form-label">ì‚¬ì§„ ë“±ë¡</label>
                <input type="file" class="form-control" id="productImage" multiple>
            </div>
            <div class="mb-3">
                <input type="text" class="form-control" id="productName" placeholder="ìƒí’ˆ ì´ë¦„">
            </div>
            <div class="mb-3">
                <textarea class="form-control" id="productDescription" placeholder="ìƒí’ˆ ì„¤ëª…"></textarea>
            </div>
            <div class="mb-3">
                <input type="number" class="form-control" id="productPrice" placeholder="ìƒí’ˆ ê°€ê²©">
            </div>
            <button class="btn btn-success w-100" onclick="sellProduct()">íŒë§¤í•˜ê¸°</button>
        </div>
    </div>

    <!-- My Page -->
    <div id="myPage" class="d-none">
        <div class="container">
            <button class="btn btn-secondary mb-3" onclick="showMainPage()">â† í™ˆìœ¼ë¡œ</button>
            <h2 class="text">My Profile</h2>
            <p><strong>ì´ë¦„:</strong> <span id="profileName"></span></p>
            <p><strong>í¬ì¸íŠ¸:</strong> <span id="accountBalance">0</span> </p>
            <button class="btn btn-outline-primary w-100 mb-2" onclick="showMySalesPage()">ë‚´ íŒë§¤ìƒí’ˆ</button>
            <button class="btn btn-outline-primary w-100" onclick="showWishlistPage()">ì°œë¦¬ìŠ¤íŠ¸</button>
        </div>
    </div>

    <!-- My Sales Page -->
    <div id="mySalesPage" class="d-none">
        <div class="container">
            <button class="btn btn-secondary mb-3" onclick="showMyPage()">â† ë§ˆì´í˜ì´ì§€ë¡œ</button>
            <h2 class="text-center">ë‚´ íŒë§¤ìƒí’ˆ</h2>
            <section id="mySalesList" class="d-flex flex-wrap"></section>
        </div>
    </div>

    <!-- Wishlist Page -->
    <div id="wishlistPage" class="d-none">
        <div class="container">
            <button class="btn btn-secondary mb-3" onclick="showMyPage()">â† ë§ˆì´í˜ì´ì§€ë¡œ</button>
            <h2 class="text-center">ì°œë¦¬ìŠ¤íŠ¸</h2>
            <section id="wishlistList" class="d-flex flex-wrap"></section>
        </div>
    </div>

    <!-- Product Detail Page -->
    <div id="productDetailPage" class="d-none">
        <div class="container">
            <button class="btn btn-secondary mb-3" onclick="showMainPage()">â† í™ˆìœ¼ë¡œ</button>
            <div id="productDetail" class="text-center"></div>
            <button class="btn btn-primary mt-3" onclick="purchaseProduct()">êµ¬ë§¤í•˜ê¸°</button>
        </div>
    </div>

    <script>
        async function login() {
            const user_id = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            const response = await fetch('/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ user_id, password })
            });

            const result = await response.json();
            if (response.ok) {
                document.getElementById('loginMessage').textContent = 'ë¡œê·¸ì¸ ì„±ê³µ';
                // Handle successful login (e.g., redirect to main page)
            } else {
                document.getElementById('loginMessage').textContent = result.detail;
            }
        }

        async function register() {
            const user_id = document.getElementById('registerUsername').value;
            const password = document.getElementById('registerPassword').value;
            const balance = document.getElementById('registerBalance').value;

            const response = await fetch('/signup', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ user_id, password, balance })
            });

            const result = await response.json();
            if (response.ok) {
                document.getElementById('registerMessage').textContent = 'íšŒì›ê°€ì… ì„±ê³µ';
                // Handle successful registration (e.g., redirect to login page)
            } else {
                document.getElementById('registerMessage').textContent = result.detail;
            }
        }

        function showSection(sectionId) {
            document.getElementById('login').classList.add('d-none');
            document.getElementById('register').classList.add('d-none');
            document.getElementById(sectionId).classList.remove('d-none');
        }
    </script>
    <script src="../static/script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>